@ECHO OFF
CD\ARTSYSTEM
ECHO.
COLOR 1F
ECHO.


SET TEMP_PATH=%TEMP%

FOR /F %%F IN ('DIR /B /OD %TEMP_PATH%\NFe_Util') DO SET NFE_UTIL_DATE_TEMP=%%~tF

FOR /F %%F IN ('DIR /B /OD .\NFe_Util') DO SET NFE_UTIL_DATE_ARTSYSTEM=%%~tF

CALL :COMPARE_DATES "%NFE_UTIL_DATE_TEMP%" "%NFE_UTIL_DATE_ARTSYSTEM%"

IF "%MODIFIED%"=="1" (
    XCOPY NFe_Util %TEMP_PATH%\NFe_Util /S /Y
)

COPY *.DLL %TEMP_PATH%
COPY *.SQL %TEMP_PATH%
COPY ART_SYSTEM.EXE %TEMP_PATH%\ART_SYSTEM.EXE

START %TEMP_PATH%\ART_SYSTEM.EXE %1
GOTO :EOF

:COMPARE_DATES
SETLOCAL
SET MODIFIED=0

SET "NFE_UTIL_DATE_TEMP=%~1"
SET "NFE_UTIL_DATE_ARTSYSTEM=%~2"

IF "%NFE_UTIL_DATE_TEMP%" LSS "%NFE_UTIL_DATE_ARTSYSTEM%" SET MODIFIED=1

ENDLOCAL & SET MODIFIED=%MODIFIED%
GOTO :EOF
